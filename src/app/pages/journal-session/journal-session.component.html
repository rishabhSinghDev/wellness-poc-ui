<div
    class="min-h-screen bg-[#fefefe] dark:bg-[#1e1e2f] text-[#4a4a4a] dark:text-[#f4f4f4] px-6 py-10 flex flex-col items-center justify-center font-sans">

    <div
        class="w-full max-w-xl bg-white/10 dark:bg-white/10 backdrop-blur-xl shadow-xl ring-1 ring-white/20 border border-white/20 rounded-xl p-8 flex flex-col items-center gap-6 animate-fade-in-up">

        <ng-container *ngIf="!completed">
            <h1 class="text-2xl md:text-3xl font-semibold text-center text-slate-800 dark:text-white">
                üìù Journal Session
            </h1>

            <p class="text-center text-sm md:text-base text-slate-600 dark:text-slate-300 max-w-md">
                {{ prompt }}
            </p>
            <textarea [(ngModel)]="currentAnswer" placeholder="Type your reflection here..." rows="5" class="w-full p-4 rounded-lg border border-white/30 backdrop-blur-md shadow-md resize-none focus:outline-none focus:ring-2 focus:ring-sky-400 dark:focus:ring-cyan-500
         bg-white text-gray-800 placeholder-gray-500
         dark:bg-[#2d2d2d] dark:text-white dark:placeholder-gray-400 text-sm md:text-base">
</textarea>
            <div *ngIf="interimTranscript" class="text-xs italic text-gray-500 dark:text-gray-400 mt-2">
                Live: {{ interimTranscript }}
            </div>
            <button (click)="toggleRecording()" class="mt-4 text-cyan-500 hover:text-cyan-700">
                üé§ {{ isRecording ? 'Listening...' : 'Start Speaking' }}
            </button>

            <button *ngIf="isRecording" (click)="cancelRecording()"
                class="bg-red-500 text-white px-3 py-1 rounded-full hover:bg-red-600 transition">
                ‚úñÔ∏è Cancel
            </button>
            <button (click)="submitAnswer()"
                class="bg-gradient-to-r from-cyan-400 to-sky-500 text-white text-base md:text-lg font-semibold px-6 py-3 rounded-full shadow-md hover:scale-105 transition duration-300 max-w-fit">
                Submit
            </button>
        </ng-container>

        <ng-container *ngIf="completed">
            <div
                class="text-center text-base md:text-lg text-white/90 dark:text-slate-300 font-medium animate-fade-in-up px-4 space-y-2">

                <p>
                    <strong>Emotion:</strong> {{ emotionToEmoji(emotionValue) }}
                </p>

                <p>
                    <strong>Summary:</strong> {{ summaryText }}
                </p>
            </div>
            <p class="text-lg md:text-xl font-semibold text-cyan-600 dark:text-cyan-400 text-center">
                Great job reflecting! See you next time {{storedName}}. üåü
            </p>
        </ng-container>

        <div class="w-full flex justify-center pt-4">
            <a routerLink="/home" class="text-sm text-sky-600 hover:underline dark:text-cyan-400">
                ‚Üê Back to Home
            </a>
        </div>
    </div>
</div>